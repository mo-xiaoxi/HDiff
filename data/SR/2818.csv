sentences
"Keywords ""MUST"", ""MUST NOT"", ""REQUIRED"", ""SHOULD"", ""SHOULD NOT"" and ""MAY"" that appear in this document are to be interpreted as described in [RFC2119]."
"Conceptually, HTTP/TLS is very simple."
"When a valid closure alert is received, an implementation can be assured that no further data will be received on that connection."
"A TLS implementation MAY, after sending a closure alert, close the connection without waiting for the peer to send its closure alert, generating an ""incomplete close""."
"As specified in [RFC2246], any implementation which receives a connection close without first receiving a valid closure alert (a ""premature close"") MUST NOT reuse that session."
"Note that a premature close does not call into question the security of the data already received, but simply indicates that subsequent data might have been truncated."
"Because TLS is oblivious to HTTP request/response boundaries, it is necessary to examine the HTTP data itself (specifically the Content-Length header) to determine whether the truncation occurred inside a message or between messages."
A HTTP response without a Content-Length header.
Since data length in this situation is signalled by connection close a premature close generated by the server cannot be distinguished from a spurious close generated by an attacker.
A HTTP response with a valid Content-Length header closed before all data has been read.
"Because TLS does not provide document oriented protection, it is impossible to determine whether the server has miscomputed the Content-Length or an attacker has truncated the connection."
"When encountering a premature close, a client SHOULD treat as completed all requests for which it has received as much data as specified in the Content-Length header."
A client detecting an incomplete close SHOULD recover gracefully.
"Clients which are unprepared to receive any more data MAY choose not to wait for the server's closure alert and simply close the connection, thus generating an incomplete close on the server side."
"RFC 2616 permits an HTTP client to close the connection at any time, and requires servers to recover gracefully."
"In particular, servers SHOULD be prepared to receive an incomplete close from the client, since the client can often determine when the end of server data is."
"In HTTP implementations which do not use persistent connections, the server ordinarily expects to be able to signal end of data by closing the connection."
"Servers MAY close the connection after sending the closure alert, thus generating an incomplete close on the client side."
This does not preclude HTTP/TLS from being run over another transport.
"If the client has external information as to the expected identity of the server, the hostname check MAY be omitted."
"E.g., *.a.com matches foo.a.com but not bar.foo.a.com."
f*.com matches foo.com but not bar.com.
"If the hostname does not match the identity in the certificate, user oriented clients MUST either notify the user (clients MAY give the user the opportunity to continue with the connection in any case) or terminate the connection with a bad certificate error."
Automated clients MUST log the error to an appropriate audit log (if available) and SHOULD terminate the connection (with a bad certificate error).
"Automated clients MAY provide a configuration setting that disables this check, but MUST provide a setting which enables it."
The above-described check provides no protection against attacks where this source is compromised.
"Typically, the server has no external knowledge of what the client's identity ought to be and so checks (other than that the client has a certificate chain rooted in an appropriate CA) are not possible."
"This document and translations of it may be copied and furnished to others, and derivative works that comment on or otherwise explain it or assist in its implementation may be prepared, copied, published and distributed, in whole or in part, without restriction of any kind, provided that the above copyright notice and this paragraph are included on all such copies and derivative works."
"However, this document itself may not be modified in any way, such as by removing the copyright notice or references to the Internet Society or other Internet organizations, except as needed for the purpose of developing Internet standards in which case the procedures for copyrights defined in the Internet Standards process must be followed, or as required to translate it into languages other than English."
"This document and the information contained herein is provided on an ""AS IS"" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE."
